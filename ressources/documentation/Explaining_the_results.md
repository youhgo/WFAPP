# 🔎 WAPP Parser Project – Explaining the Results

This document explains how to navigate and interpret the results generated by **WAPP (Windows Artefact Parser Project)** after parsing DFIR-ORC archives.

---

## 📌 Useful Links

* **WAPP Repository:** [Available here](https://github.com/youhgo/WFAPP)
* **Installation tutorial:** [Installation Guide](https://github.com/youhgo/WFAPP/blob/master/ressources/documentation/how_to_install.md)
* **Usage tutorial:** [Usage Guide](https://github.com/youhgo/WFAPP/blob/master/ressources/documentation/how_to_use.md)
* **DFIR-ORC Configuration:** [Tutorial](https://github.com/youhgo/WFAPP/blob/master/ressources/documentation/configure_orc.md)

---

## 📂 Results Location

Once WAPP finishes parsing, results are stored in the **shared folder** you configured in your `docker-compose.yml` file.

---

## 🗂️ WAPP Results Architecture

WAPP structures its output as follows:

```bash
Your_Share_Folder
├── depot/        # Raw ORC archives uploaded via the API
└── work/         # Parsed artefacts and logs
    ├── execution_logs/   # Logs from DOPP processing
    ├── casename/         # Results grouped under the case name provided in the API
    │   ├── WorkStation_DESKTOP-9I162HO_new_2024-09-08T23:45:46
    │   └── DomainController_FOREST.htb.local_2024-09-16T05:47:18
    └── test/             # Another example case (casename = "test")
        └── WorkStation_DESKTOP-9I162HO_new_2024-09-16T05:33:48
```

Each **case folder** contains all parsed results tied to that case, with subfolders for every parsed machine.

---

## 🧩 Parsed DFIR-ORC Archive Structure

When parsing a DFIR-ORC archive, WAPP generates the following structure:

```bash
DomainController_FOREST_2024-08-18T04:16:47
└── parsed/
    ├── debug/       # Execution logs of DFIR-ORC
    ├── events/      # EVTX events (JSON)
    ├── hives/       # Registry hives (Yarp + regipy)
    ├── lnk/         # LNK files (JSON)
    ├── mft/         # USN journal + MFT (CSV)
    ├── network/     # Network-related outputs (CSV/TXT)
    ├── powershell/  # PowerShell history & scripts
    ├── prefetch/    # Prefetch files (CSV/JSON)
    ├── process/     # Process information (CSV)
    ├── SRUM/        # srudb.dat (CSV)
    ├── textLogs/    # Plain text logs
    ├── timeline/    # Timeline created by PLASO (JSON + CSV)
    ├── mpp_machine_name_2024-08-18T04:16:47/   # outputp of MaximumPlasoParser
    └── parsed_for_human/ # Unified CSV summaries (human-readable)
```

Note: WAPP launch MaximumPlasoParser as well, full info about the tool [here](https://github.com/youhgo/maximumPlasoTimelineParser)

---

## 👀 `parsed_for_human` Folder

The **`parsed_for_human`** folder aggregates the most useful artefacts into **readable CSV files** with consistent formats (`DATE|TIME|ID|...`).

Keep in mind that this folder **doesn't aggregate ALL artefacts** , some other artefact are located in they're designed directories 

Note: The Hive complex structure is hard to transpose as CSV and keept it readable, that's why they are left as Json line. 
Only the Amcache is parsed as CSV as well. 

### 🕵️ Example: Detecting Malicious Activity

From these results, you can quickly detect:

* 🔑 Use of **Mimikatz**
* 💀 A **Cobalt Strike beacon**
* 🐚 A **backdoor**
* 🦠 **Ransomware execution**
* 🛡️ **Antivirus disabling**
* 👤 Compromised user logons

**Sample Investigation (with `ripgrep`):**

```bash
rg -i "2021-01-07\|03.(3|4|5)" \
   user_logon_id4624.csv \
   new_service_id7045.csv \
   Amcache.hve_regpy.csv \
   powershell.csv \
   windefender.csv
```

**Output (excerpt):**

```bash
windefender.csv
2021-01-07|03:32:30|1116 - Detection|VirTool:Win32/MSFPsExecCommand|Severe|NT AUTHORITY\SYSTEM|...|CmdLine:_C:\Windows\System32\cmd.exe ...

2021-01-07|03:35:44|1116 - Detection|HackTool:Win64/Mikatz!dha|High|BROCELIANDE\\arthur|C:\Users\Public\mimikatz.exe|...

app_compat_cache.csv
2021-01-07|03:39:31|beacon.exe|C:\Users\Public\beacon.exe|...

powershell.csv
2021-01-07|03:37:03|600|powershell Set-MpPreference -DisableRealtimeMonitoring $true; ...
```

---

### The results

 Please note that you will only get the full output if you use the DFIR-ORC config provided with ORC.

I've also provided a configured and ready to go [DFIR-ORC](https://github.com/youhgo/WFAPP/tree/master/api/ressources) collector. 

More info: [here](https://github.com/youhgo/WFAPP/blob/master/ressources/documentation/configure_orc.md)

The contents of the `parsed_for_human` directory is detailed below:

| **File Path**                   | **Description**                                                        | Prerequire                               | Come with ORC | Come with OTHER | 
 |---------------------------------|------------------------------------------------------------------------|------------------------------------------|---------------|-----------------| 
| `parsed_for_human/`             | The root directory containing all human-readable parsed artifacts.     | None                                     | N/A           | N/A             |
| `Amcache.hve_regpy.csv`         | Amcache simplified with DATE, TIME, Entry, and Hash.                   | None                                     | ✅             | ✅               | 
| `Amcache.hve_yarp.jsonl`        | Amcache hive where each entry is a JSON line.                          | None                                     | ✅             | ✅               | 
| `NTUSER.DAT_yarp.jsonl`         | User-specific registry hive where each entry is a JSON line.           | None                                     | ✅             | ✅               | 
| `SAM_yarp.jsonl`                | Security Account Manager (SAM) hive where each entry is a JSON line.   | None                                     | ✅             | ✅               | 
| `SECURITY_yarp.jsonl`           | Security registry hive where each entry is a JSON line.                | None                                     | ✅             | ✅               | 
| `SOFTWARE_yarp.jsonl`           | Software registry hive where each entry is a JSON line.                | None                                     | ✅             | ✅               | 
| `SYSTEM_yarp.jsonl`             | System registry hive where each entry is a JSON line.                  | None                                     | ✅             | ✅               | 
| `UsrClass.dat_yarp.jsonl`       | User class registry hive where each entry is a JSON line.              | None                                     | ✅             | ✅               | 
| `autoruns_sysinternals_parsed.csv` | Output of SysInternals autoruns tool                                | autoruns.exe must be configured within ORC | ✅           | ❌               | 
| `bits.csv`                      | Summary of BITS (Background Intelligent Transfer Service) connections. | None                                     | ✅             | ✅               | 
| `local_rdp.csv`                 | All local RDP connections                                              | None                                     | ✅             | ✅               | 
| `lnk.csv`                       | All lnk files formatted                                                | None                                     | ✅             | ✅               |
| `mft_as_timeline.csv`           | MFT parsed as a timeline                                               | None                                     | ✅             | ✅               | 
| `netstat_parsed.csv`            | Output of the `netstat` tool                                           | netstat must be configured within ORC    | ✅             | ❌               | 
| `new_proc_file_id4688.csv`      | Windows Event ID 4688 (new process created)                            | None                                     | ✅             | ✅               | 
| `new_service_id7045.csv`        | Windows Event ID 7045 (new service created)                            | None                                     | ✅             | ✅               | 
| `powershell.csv`                | PowerShell command logs                                                | None                                     | ✅             | ✅               | 
| `powershell_script.csv`         | PowerShell script logs                                                 | None                                     | ✅             | ✅               | 
| `process1_parsed.csv`           | All processes formatted with a parent-child tree style.                | None                                     | ✅             | ❌               | 
| `process1_simplified.csv`       | A simplified version of the process tree with less information.        | None                                     | ✅             | ❌               | 
| `process2_parsed.csv`           | Comprehensive process information.                                     | None                                     | ✅             | ❌               | 
| `process_autoruns_parsed.csv`   | Info about processes that automatically start up.                      | None                                     | ✅             | ❌               | 
| `process_sampleinfo_parsed.csv` | Additional process information.                                        | None                                     | ✅             | ❌               | 
| `process_timeline_parsed.csv`   | Process information formatted as a timeline.                           | None                                     | ✅             | ❌               | 
| `remote_rdp.csv`                | All remote RDP connections                                             | None                                     | ✅             | ✅               | 
| `systeminfo.json`               | System information parsed in JSON format.                              | None                                     | ✅             | ❌               | 
| `systeminfo.txt`                | System information parsed in plain text format.                        | None                                     | ✅             | ❌               | 
| `task_scheduler.csv`            | All info on scheduled tasks                                            | None                                     | ✅             | ✅               | 
| `tcpvcon_parsed.csv`            | Output of the `tcpvcon` tool                                           | tcpvcon must be configured within ORC    | ✅             | ❌               | 
| `user_explicit_logon_id4648.csv` | Windows Event ID 4648 (explicit user logon)                           | None                                     | ✅             | ✅               | 
| `user_failed_logon_id4625.csv`  | Windows Event ID 4625 (failed user logon)                              | None                                     | ✅             | ✅               | 
| `user_logon_id4624.csv`         | Windows Event ID 4624 (user logon)                                     | None                                     | ✅             | ✅               | 
| `user_special_logon_id4672.csv` | Windows Event ID 4672 (user special logon)                             | None                                     | ✅             | ✅               | 
| `USN_parsed.csv`                | USN Journal data                                                       | None                                     | ✅             | ✅               | 
| `windefender.csv`               | Windows Defender logs                                                  | None                                     | ✅             | ✅               | 
| `windows_start_stop.csv`        | Windows startup and shutdown events                                    | None                                     | ✅             | ✅               | 
| `wmi.csv`                       | WMI register and command logs.                                         | None                                     | ✅             | ✅               | 

This is the **go-to folder** for investigators since it contains the most accessible summaries.

---



## ✅ Summary

* Results are structured by **case name** and **machine**.
* Each parsed archive contains both **raw artefacts** and **human-readable CSV summaries**.
* Analysts should prioritize the `parsed_for_human` folder for quick triage.
* Correlating artefacts across logs reveals attacker techniques (e.g., persistence, credential dumping, lateral movement).

---

✨ With WAPP, you can move from raw forensic artefacts to **actionable intelligence** in minutes.

---